<style>
  .b {
    color: magenta!important;
  }
  @media screen and (max-width: 500px) {
    .b {
      color: red!important;
    }
  }
</style>

<div>
  <p class="b">
    This should be red <= 500px and magenta > 500px
  </p>
  <div class="shadow-dom">
    <style>
      .b {
        color: green;
      }
      @media screen and (min-width: 500px) {
        .b {
          color: blue;
        }
      }
    </style>
    <p class="b">
      This should be blue >= 500px and green < 500px
    </p>
  </div>
</div>
